{% extends "base.html" %}
{% load cotton %}

{% block body_class %}min-h-screen font-poppins bg-background text-foreground{% endblock %}

{% block main_class %}h-screen overflow-hidden{% endblock %}

{% block layout %}
<!-- Board Layout: No Navbar/Footer -->
{% block content %}

<div class="flex h-screen bg-background" x-data="{ sidebarOpen: true }">
    <!-- Sidebar -->
    <aside id="sidebar" :class="sidebarOpen ? 'w-64' : 'w-16'" class="bg-card border-r border-border flex-shrink-0 flex flex-col transition-all duration-300 ease-in-out overflow-hidden">
        <!-- Sidebar Header -->
        <div class="h-14 px-3 border-b border-border flex items-center justify-between gap-2">
            <div class="flex items-center gap-2 min-w-0 overflow-hidden">
                <svg class="h-5 w-5 text-primary flex-shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7" rx="1" />
                    <rect x="14" y="3" width="7" height="7" rx="1" />
                    <rect x="14" y="14" width="7" height="7" rx="1" />
                    <rect x="3" y="14" width="7" height="7" rx="1" />
                </svg>
                <span x-show="sidebarOpen" x-transition class="text-lg font-semibold text-foreground whitespace-nowrap overflow-hidden">Taskify</span>
            </div>
            <button @click="sidebarOpen = !sidebarOpen" class="p-1 hover:bg-accent rounded transition-colors flex-shrink-0">
                <svg class="h-4 w-4 text-muted-foreground" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2" />
                    <path d="M9 3v18" />
                </svg>
            </button>
        </div>

        <!-- Sidebar Navigation -->
        <nav class="flex-1 p-2 overflow-y-auto">
            <ul class="space-y-1">
                <li>
                    <a href="{% url 'board-home' %}" class="flex items-center gap-2 px-3 py-2 text-sm text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors" :title="!sidebarOpen ? 'Workspaces' : ''">
                        <svg class="h-4 w-4 flex-shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                            <polyline points="9 22 9 12 15 12 15 22" />
                        </svg>
                        <span x-show="sidebarOpen" x-transition class="whitespace-nowrap text-sm">Workspaces</span>
                    </a>
                </li>
                <li>
                    <button id="open-invite-modal" class="w-full flex items-center gap-2 px-3 py-2 text-sm text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors" :title="!sidebarOpen ? 'Members' : ''">
                        <svg class="h-4 w-4 flex-shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
                            <circle cx="9" cy="7" r="4" />
                            <path d="M22 21v-2a4 4 0 0 0-3-3.87" />
                            <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                        </svg>
                        <span x-show="sidebarOpen" x-transition class="whitespace-nowrap text-sm">Members</span>
                    </button>
                </li>
                <li>
                    <button id="open-background-modal" class="w-full flex items-center gap-2 px-3 py-2 text-sm text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors" :title="!sidebarOpen ? 'Background' : ''">
                        <svg class="h-4 w-4 flex-shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                            <circle cx="9" cy="9" r="2" />
                            <path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21" />
                        </svg>
                        <span x-show="sidebarOpen" x-transition class="whitespace-nowrap text-sm">Background</span>
                    </button>
                </li>
                <li>
                    <a href="#" class="flex items-center gap-2 px-3 py-2 text-sm text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors" :title="!sidebarOpen ? 'Analytics' : ''">
                        <svg class="h-4 w-4 flex-shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21.21 15.89A10 10 0 1 1 8 2.83" />
                            <path d="M22 12A10 10 0 0 0 12 2v10z" />
                        </svg>
                        <span x-show="sidebarOpen" x-transition class="whitespace-nowrap text-sm">Analytics</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'board-home' %}" class="flex items-center gap-2 px-3 py-2 text-sm text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-colors" :title="!sidebarOpen ? 'All Boards' : ''">
                        <svg class="h-4 w-4 flex-shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="7" height="7" rx="1" />
                            <rect x="14" y="3" width="7" height="7" rx="1" />
                            <rect x="14" y="14" width="7" height="7" rx="1" />
                            <rect x="3" y="14" width="7" height="7" rx="1" />
                        </svg>
                        <span x-show="sidebarOpen" x-transition class="whitespace-nowrap text-sm">All Boards</span>
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Sidebar Footer - User Profile -->
        <div class="p-2 border-t border-border">
            <a href="{% url 'user-profile' %}" class="flex items-center gap-2 px-2 py-2 hover:bg-accent rounded-md transition-colors" :title="!sidebarOpen ? '{{user.username}}' : ''">
                <div class="h-8 w-8 flex-shrink-0 flex items-center justify-center bg-primary text-primary-foreground rounded-full font-semibold text-sm">
                    <span class="hidden" id="self-user">{{user.id}}</span>
                    {{ user.username|slice:":1"|upper }}
                </div>
                <div x-show="sidebarOpen" x-transition class="flex-1 min-w-0">
                    <div class="text-xs font-medium text-foreground truncate">
                        {{user.username}}
                    </div>
                    <div class="text-[10px] text-muted-foreground truncate">
                        {{user.email}}
                    </div>
                </div>
            </a>
        </div>
    </aside>

    <!-- Main Content Area -->
    <div class="flex-1 flex flex-col overflow-hidden">
        <!-- Board Header -->
        <header class="bg-card border-b border-border px-4 py-3">
            <div class="flex items-center justify-between">
                <span id="board-id" class="hidden">{{ board.id }}</span>
                <div class="flex-1">
                    <input 
                        id="edit-name" 
                        type="text"
                        class="text-xl font-bold bg-transparent border-none outline-none focus:ring-2 focus:ring-ring rounded-md px-2 py-1 -ml-2 text-foreground"
                        value="{{ board.name }}"
                        autocomplete="off"
                    />
                </div>
                <div class="flex items-center gap-3">
                    <!-- Theme Toggle -->
                    <label class="swap swap-rotate btn btn-ghost btn-circle btn-sm">
                        <input 
                            type="checkbox" 
                            id="theme-toggle"
                            x-model="darkMode"
                            @change="localStorage.setItem('darkMode', darkMode)"
                        />
                        <svg x-show="!darkMode" class="swap-off h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="5" />
                            <line x1="12" y1="1" x2="12" y2="3" />
                            <line x1="12" y1="21" x2="12" y2="23" />
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" />
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" />
                            <line x1="1" y1="12" x2="3" y2="12" />
                            <line x1="21" y1="12" x2="23" y2="12" />
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" />
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" />
                        </svg>
                        <svg x-show="darkMode" class="swap-on h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
                        </svg>
                    </label>
                    
                    <!-- Add Members Button -->
                    <c-ui.button id="add-members-btn" variant="default" size="sm">
                        <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
                            <circle cx="9" cy="7" r="4" />
                            <line x1="19" y1="8" x2="19" y2="14" />
                            <line x1="22" y1="11" x2="16" y2="11" />
                        </svg>
                        Add Members
                    </c-ui.button>
                </div>
            </div>
        </header>

        <!-- Board Content - Lists Container -->
        <main class="flex-1 overflow-x-auto overflow-y-hidden p-4">
            <div id="list-container" class="flex gap-4 h-full min-w-max">
                <!-- Sample List 1: To Do -->
                <div class="w-72 flex-shrink-0">
                    <div class="bg-card rounded-lg border border-border h-full flex flex-col shadow-sm">
                        <div class="p-3 border-b border-border flex items-center justify-between">
                            <h3 class="font-semibold text-foreground">To Do</h3>
                            <button class="text-muted-foreground hover:text-foreground">
                                <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="1" />
                                    <circle cx="12" cy="5" r="1" />
                                    <circle cx="12" cy="19" r="1" />
                                </svg>
                            </button>
                        </div>
                        <div class="flex-1 overflow-y-auto p-3 space-y-2">
                            <div class="bg-background p-3 rounded-md border border-border hover:border-ring cursor-pointer transition-colors group">
                                <p class="text-sm text-foreground font-medium">Design new landing page</p>
                                <div class="flex items-center gap-2 mt-2">
                                    <span class="text-xs px-2 py-0.5 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded">Urgent</span>
                                    <span class="text-xs text-muted-foreground">Due: Nov 5</span>
                                </div>
                            </div>
                            <div class="bg-background p-3 rounded-md border border-border hover:border-ring cursor-pointer transition-colors">
                                <p class="text-sm text-foreground font-medium">Update documentation</p>
                                <div class="flex items-center gap-2 mt-2">
                                    <span class="text-xs px-2 py-0.5 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded">Important</span>
                                </div>
                            </div>
                            <div class="bg-background p-3 rounded-md border border-border hover:border-ring cursor-pointer transition-colors">
                                <p class="text-sm text-foreground font-medium">Review pull requests</p>
                            </div>
                        </div>
                        <div class="p-3 border-t border-border">
                            <button class="w-full text-sm text-muted-foreground hover:text-foreground hover:bg-accent rounded-md py-2 transition-colors flex items-center justify-center gap-2">
                                <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="12" y1="5" x2="12" y2="19" />
                                    <line x1="5" y1="12" x2="19" y2="12" />
                                </svg>
                                Add card
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Sample List 2: In Progress -->
                <div class="w-72 flex-shrink-0">
                    <div class="bg-card rounded-lg border border-border h-full flex flex-col shadow-sm">
                        <div class="p-3 border-b border-border flex items-center justify-between">
                            <h3 class="font-semibold text-foreground">In Progress</h3>
                            <button class="text-muted-foreground hover:text-foreground">
                                <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="1" />
                                    <circle cx="12" cy="5" r="1" />
                                    <circle cx="12" cy="19" r="1" />
                                </svg>
                            </button>
                        </div>
                        <div class="flex-1 overflow-y-auto p-3 space-y-2">
                            <div class="bg-background p-3 rounded-md border border-border hover:border-ring cursor-pointer transition-colors">
                                <p class="text-sm text-foreground font-medium">Implement user authentication</p>
                                <div class="flex items-center gap-2 mt-2">
                                    <div class="flex -space-x-2">
                                        <div class="h-6 w-6 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-xs border-2 border-background">A</div>
                                        <div class="h-6 w-6 rounded-full bg-secondary text-secondary-foreground flex items-center justify-center text-xs border-2 border-background">B</div>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-background p-3 rounded-md border border-border hover:border-ring cursor-pointer transition-colors">
                                <p class="text-sm text-foreground font-medium">Fix responsive issues</p>
                                <div class="flex items-center gap-2 mt-2">
                                    <span class="text-xs px-2 py-0.5 bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300 rounded">Bug</span>
                                </div>
                            </div>
                        </div>
                        <div class="p-3 border-t border-border">
                            <button class="w-full text-sm text-muted-foreground hover:text-foreground hover:bg-accent rounded-md py-2 transition-colors flex items-center justify-center gap-2">
                                <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="12" y1="5" x2="12" y2="19" />
                                    <line x1="5" y1="12" x2="19" y2="12" />
                                </svg>
                                Add card
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Sample List 3: Done -->
                <div class="w-72 flex-shrink-0">
                    <div class="bg-card rounded-lg border border-border h-full flex flex-col shadow-sm">
                        <div class="p-3 border-b border-border flex items-center justify-between">
                            <h3 class="font-semibold text-foreground">Done</h3>
                            <button class="text-muted-foreground hover:text-foreground">
                                <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="1" />
                                    <circle cx="12" cy="5" r="1" />
                                    <circle cx="12" cy="19" r="1" />
                                </svg>
                            </button>
                        </div>
                        <div class="flex-1 overflow-y-auto p-3 space-y-2">
                            <div class="bg-background p-3 rounded-md border border-border hover:border-ring cursor-pointer transition-colors opacity-75">
                                <p class="text-sm text-foreground font-medium line-through">Setup project structure</p>
                                <div class="flex items-center gap-2 mt-2">
                                    <span class="text-xs px-2 py-0.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded">Completed</span>
                                </div>
                            </div>
                            <div class="bg-background p-3 rounded-md border border-border hover:border-ring cursor-pointer transition-colors opacity-75">
                                <p class="text-sm text-foreground font-medium line-through">Create database schema</p>
                            </div>
                        </div>
                        <div class="p-3 border-t border-border">
                            <button class="w-full text-sm text-muted-foreground hover:text-foreground hover:bg-accent rounded-md py-2 transition-colors flex items-center justify-center gap-2">
                                <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="12" y1="5" x2="12" y2="19" />
                                    <line x1="5" y1="12" x2="19" y2="12" />
                                </svg>
                                Add card
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Add List Button -->
                <div class="w-72 flex-shrink-0">
                    <button class="w-full h-full min-h-[120px] bg-card/50 hover:bg-card border-2 border-dashed border-border hover:border-ring rounded-lg transition-colors flex items-center justify-center gap-2 text-muted-foreground hover:text-foreground">
                        <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19" />
                            <line x1="5" y1="12" x2="19" y2="12" />
                        </svg>
                        <span class="font-medium">Add another list</span>
                    </button>
                </div>
            </div>
        </main>
    </div>
</div>

{% endblock content %}
{% endblock layout %}
