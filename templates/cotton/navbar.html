<c-vars show_nav_links="true" show_boards_link="false" />
<!-- Unified Navbar Component -->
<div
  class="h-16 bg-card border-b border-border sticky top-0 z-50 shadow-sm flex items-center justify-between"
  x-data="{ mobileMenuOpen: false }"
>
  <div class="container-fluid px-4 sm:px-6 lg:px-8 w-full">
    <div class="flex items-center justify-between w-full">
      <!-- Left Side: Brand -->
      <a
        href="{% url 'board-landing' %}"
        class="flex items-center gap-2 text-xl font-semibold text-foreground hover:text-primary transition-colors"
      >
        <svg
          class="h-6 w-6"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <rect x="3" y="3" width="7" height="7" rx="1" />
          <rect x="14" y="3" width="7" height="7" rx="1" />
          <rect x="14" y="14" width="7" height="7" rx="1" />
          <rect x="3" y="14" width="7" height="7" rx="1" />
        </svg>
        <span>Taskify</span>
      </a>

      <!-- Right Side: Navigation + Theme + Auth -->
      <div class="flex items-center gap-6">
        <!-- Navigation Links (Desktop) - Only show on landing/marketing pages -->
        {% if show_nav_links == "true" %}
        <nav class="hidden md:flex items-center gap-6">
          <a
            href="{% url 'board-landing' %}"
            class="text-muted-foreground hover:text-foreground transition-colors"
            >Home</a
          >
          <a
            href="{% url 'board-contact' %}"
            class="text-muted-foreground hover:text-foreground transition-colors"
            >Contact</a
          >
          <a
            href="{% url 'board-about' %}"
            class="text-muted-foreground hover:text-foreground transition-colors"
            >About</a
          >
          <a
            href="{% url 'blog:list' %}"
            class="text-muted-foreground hover:text-foreground transition-colors"
            >Blog</a
          >
        </nav>
        {% endif %}

        <!-- Theme Toggle Button -->
        <label class="swap swap-rotate btn btn-ghost btn-circle btn-sm">
          <input
            type="checkbox"
            x-model="darkMode"
            @change="localStorage.setItem('darkMode', darkMode)"
          />
          <svg
            x-show="!darkMode"
            class="swap-off h-5 w-5"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <circle cx="12" cy="12" r="5" />
            <line x1="12" y1="1" x2="12" y2="3" />
            <line x1="12" y1="21" x2="12" y2="23" />
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" />
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" />
            <line x1="1" y1="12" x2="3" y2="12" />
            <line x1="21" y1="12" x2="23" y2="12" />
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" />
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" />
          </svg>
          <svg
            x-show="darkMode"
            class="swap-on h-5 w-5"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            style="display: none"
          >
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
          </svg>
        </label>

        <!-- Auth Section (Desktop) -->
        <div class="hidden md:flex items-center gap-3">
          {% if user.is_authenticated %}
          <!-- Go to Boards Button (for auth pages) -->
          {% if show_boards_link == "true" %}
          <c-ui.button href="{% url 'board-home' %}" variant="default" size="sm">
            <svg
              class="h-4 w-4"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <rect x="3" y="3" width="7" height="7" rx="1" />
              <rect x="14" y="3" width="7" height="7" rx="1" />
              <rect x="14" y="14" width="7" height="7" rx="1" />
              <rect x="3" y="14" width="7" height="7" rx="1" />
            </svg>
            Go to Boards
          </c-ui.button>
          {% endif %}

          <!-- Profile Menu -->
          <div class="dropdown dropdown-end">
            <div
              tabindex="0"
              role="button"
              class="btn btn-ghost btn-circle avatar"
            >
              <div
                class="w-9 rounded-full ring-2 ring-transparent hover:ring-primary/20 transition-all"
              >
                {% if user.profile.image %}
                <img
                  src="{{ user.profile.image.url }}"
                  alt="{{ user.username }}"
                />
                {% else %}
                <div
                  class="bg-primary text-primary-content w-full h-full flex items-center justify-center text-sm font-semibold"
                >
                  {{ user.username|slice:":2"|upper }}
                </div>
                {% endif %}
              </div>
            </div>
            <ul
              tabindex="0"
              class="menu menu-sm dropdown-content bg-card border border-border rounded-lg z-[1] mt-3 w-52 p-2 shadow-lg"
            >
              <li class="menu-title">{{ user.username }}</li>
              <li>
                <a href="{% url 'user-profile' %}">
                  <svg
                    class="h-4 w-4"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                    <circle cx="12" cy="7" r="4" />
                  </svg>
                  Profile
                </a>
              </li>
              <li>
                <a href="{% url 'board-home' %}">
                  <svg
                    class="h-4 w-4"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <rect x="3" y="3" width="7" height="7" rx="1" />
                    <rect x="14" y="3" width="7" height="7" rx="1" />
                    <rect x="14" y="14" width="7" height="7" rx="1" />
                    <rect x="3" y="14" width="7" height="7" rx="1" />
                  </svg>
                  My Boards
                </a>
              </li>
              <li class="border-t mt-2 pt-2">
                <a href="{% url 'user-logout' %}">
                  <svg
                    class="h-4 w-4"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                    <polyline points="16 17 21 12 16 7" />
                    <line x1="21" y1="12" x2="9" y2="12" />
                  </svg>
                  Logout
                </a>
              </li>
            </ul>
          </div>
          {% else %}
          <!-- Guest User Buttons -->
          {% if show_boards_link == "true" %}
          <!-- On auth pages, show Home button -->
          <c-ui.button
            href="{% url 'board-landing' %}"
            variant="ghost"
            size="sm"
          >
            <svg
              class="h-4 w-4"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"
              />
              <polyline points="9 22 9 12 15 12 15 22" />
            </svg>
            Home
          </c-ui.button>
          {% else %}
          <!-- On landing page, show Sign in / Get Started -->
          <c-ui.button href="{% url 'user-login' %}" variant="ghost" size="sm"
            >Sign in</c-ui.button
          >
          <c-ui.button href="{% url 'user-register' %}" size="sm"
            >Get Started</c-ui.button
          >
          {% endif %} {% endif %}
        </div>

        <!-- Mobile Menu Toggle -->
        <button
          @click="mobileMenuOpen = !mobileMenuOpen"
          class="btn btn-ghost btn-circle md:hidden"
          aria-label="Toggle menu"
        >
          <svg
            class="h-6 w-6"
            :class="{ 'hidden': mobileMenuOpen, 'block': !mobileMenuOpen }"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"
            />
          </svg>
          <svg
            class="h-6 w-6"
            :class="{ 'block': mobileMenuOpen, 'hidden': !mobileMenuOpen }"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"
            />
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile Menu Dropdown -->
    <div
      x-show="mobileMenuOpen"
      x-transition:enter="transition ease-out duration-200"
      x-transition:enter-start="opacity-0 scale-95"
      x-transition:enter-end="opacity-100 scale-100"
      x-transition:leave="transition ease-in duration-150"
      x-transition:leave-start="opacity-100 scale-100"
      x-transition:leave-end="opacity-0 scale-95"
      @click.away="mobileMenuOpen = false"
      class="absolute top-full left-0 right-0 md:hidden bg-card border-b border-border shadow-lg"
      style="display: none"
    >
      <div class="px-6 py-4 space-y-3 flex flex-col">
        <!-- Navigation Links (Mobile) - Only on landing pages -->
        {% if show_nav_links == "true" %}  
        <a
          href="{% url 'board-landing' %}"
          class="text-muted-foreground hover:text-foreground transition-colors"
          >Home</a
        >
        <a
          href="{% url 'board-contact' %}"
          class="text-muted-foreground hover:text-foreground transition-colors"
          >Contact</a
        >
        <a
          href="{% url 'board-about' %}"
          class="text-muted-foreground hover:text-foreground transition-colors"
          >About</a
        >
        <a
          href="{% url 'blog:list' %}"
          class="text-muted-foreground hover:text-foreground transition-colors"
          >Blog</a
        >
        {% endif %}

        <div class="pt-4 border-t space-y-2">
          {% if user.is_authenticated %}
          <!-- User Info -->
          <div class="flex items-center gap-3 px-2 py-3 bg-muted rounded-lg">
            <div class="avatar">
              <div class="w-10 rounded-full">
                {% if user.profile.image %}
                <img
                  src="{{ user.profile.image.url }}"
                  alt="{{ user.username }}"
                />
                {% else %}
                <div
                  class="bg-primary text-primary-content w-full h-full flex items-center justify-center text-sm font-semibold"
                >
                  {{ user.username|slice:":2"|upper }}
                </div>
                {% endif %}
              </div>
            </div>
            <div class="flex-1 min-w-0">
              <p class="text-sm font-medium truncate text-foreground">
                {{ user.username }}
              </p>
              <p class="text-xs text-muted-foreground truncate">
                {{ user.email }}
              </p>
            </div>
          </div>

          <!-- Menu Items -->
          <c-ui.button
            href="{% url 'board-home' %}"
            variant="primary"
            class="w-full justify-start"
          >
            Go to Boards
          </c-ui.button>
          <c-ui.button
            href="{% url 'user-profile' %}"
            variant="ghost"
            class="w-full justify-start"
          >
            <svg
              class="h-4 w-4"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
              <circle cx="12" cy="7" r="4" />
            </svg>
            Profile
          </c-ui.button>
          <c-ui.button
            href="{% url 'user-logout' %}"
            variant="ghost"
            class="w-full justify-start"
          >
            <svg
              class="h-4 w-4"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
              <polyline points="16 17 21 12 16 7" />
              <line x1="21" y1="12" x2="9" y2="12" />
            </svg>
            Logout
          </c-ui.button>
          {% else %}
          <!-- Guest User Buttons -->
          {% if show_boards_link == "true" %}
          <c-ui.button
            href="{% url 'board-landing' %}"
            variant="default"
            class="w-full"
          >
            <svg
              class="h-4 w-4"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"
              />
              <polyline points="9 22 9 12 15 12 15 22" />
            </svg>
            Home
          </c-ui.button>
          {% else %}
          <c-ui.button
            href="{% url 'user-login' %}"
            variant="ghost"
            class="w-full"
            >Sign in</c-ui.button
          >
          <c-ui.button href="{% url 'user-register' %}" class="w-full"
            >Get Started</c-ui.button
          >
          {% endif %} {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
